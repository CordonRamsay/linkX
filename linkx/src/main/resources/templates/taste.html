<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>맛집 지도</title>
  <script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=j5sii37kyv&submodules=geocoder"></script>
</head>
<body>
<h1>맛집 지도</h1>
<div>
  <h2>MAP</h2>
  <div id="map" style="width:100%;height:400px;"></div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // 지도 초기 설정
      var mapOptions = {
        center: new naver.maps.LatLng(37.58469198890765, 126.92568962210997), // 임시 중심
        zoom: 17
      };
      var map = new naver.maps.Map('map', mapOptions);

      // 맛집 데이터 로드 함수
      function loadRestaurants() {
        fetch('/taste/data/list')
                .then(response => response.json())
                .then(restaurants => {
                  // 각 맛집에 대해 마커 추가
                  restaurants.forEach(function(restaurant) {
                    var lat = parseFloat(restaurant.mapY) / 1e7;
                    var lng = parseFloat(restaurant.mapX) / 1e7;
                    var latLng = new naver.maps.LatLng(lat, lng);

                    // 마커 생성
                    var marker = new naver.maps.Marker({
                      position: latLng,
                      map: map,
                      title: restaurant.title
                    });

                    // 정보 창 생성
                    var infoWindow = new naver.maps.InfoWindow({
                      content: `<div style="padding:5px;">${restaurant.title}</div>`
                    });

                    // 마커 클릭 시 정보 창 표시
                    naver.maps.Event.addListener(marker, "click", function() {
                      infoWindow.open(map, marker);
                    });
                  });
                })
                .catch(error => console.error('Error fetching restaurant data:', error));
      }

      // 로드 시 맛집 데이터를 불러와 지도에 표시
      loadRestaurants();
    });
  </script>
</div>
<div>
  <h2>REVIEW</h2>
  <script>
    // 리뷰 리스트를 로드하여 표시하는 함수
    //  function loadReviews() {
    //   fetch('/taste/data/list/details')
    //           .then(response => response.json())
    //           .then(restaurants => {
    //             const reviewContainer = document.getElementById('review-list');
    //             reviewContainer.innerHTML = ''; // 기존 내용을 비웁니다.
    //
    //             restaurants.forEach(restaurant => {
    //               // 각 음식점 정보를 담을 div 생성
    //               const reviewItem = document.createElement('div');
    //               reviewItem.classList.add('review-item');
    //               reviewItem.innerHTML = `
    //           <div>
    //             <strong>${restaurant.title}</strong>
    //           </div>
    //           <div>${restaurant.addr}</div>
    //           <div>${restaurant.roadAddr}</div>
    //           <div>리뷰 개수: ${restaurant.reviewCount || 0}</div>
    //           <div>좋아요 수: ${restaurant.likeCount || 0}</div>
    //         `;
    //               reviewContainer.appendChild(reviewItem);
    //             });
    //           })
    //           .catch(error => console.error('Error fetching review data:', error));
    // }

  </script>
</div>
</body>
</html>
